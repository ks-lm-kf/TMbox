<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TMbox - æ ‘è“æ´¾æ”»é˜²æ§åˆ¶å°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="/socket.io/socket.io.js"></script>
    <style>
        body { background-color: #0f172a; color: #e2e8f0; }
        .terminal-font { font-family: 'Consolas', 'Courier New', monospace; }
        /* éœ“è™¹ç¯æ•ˆæœ */
        .neon-border { box-shadow: 0 0 10px #3b82f6; }
        /* æ»šåŠ¨æ¡æ ·å¼ */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1e293b; }
        ::-webkit-scrollbar-thumb { background: #475569; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #64748b; }
    </style>
</head>
<body class="h-screen flex flex-col p-4 overflow-hidden">

    <!-- é¡¶éƒ¨çŠ¶æ€æ  -->
    <header class="flex justify-between items-center mb-4 border-b border-slate-700 pb-2">
        <h1 class="text-2xl font-bold text-blue-500 tracking-widest">TM<span class="text-white">box</span></h1>
        <div class="flex space-x-3">
            <!-- CPU çŠ¶æ€æ˜¾ç¤º -->
            <div class="flex items-center space-x-2 px-3 py-1 bg-slate-800 rounded border border-slate-600">
                <div class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
                <span class="text-xs text-slate-300">CPU: <span id="cpuVal" class="font-bold text-white">Loading...</span>%</span>
            </div>
            <span class="px-3 py-1 bg-blue-900 text-blue-300 rounded text-xs border border-blue-700">NET: HOST</span>
        </div>
    </header>

    <div class="flex flex-1 gap-4 overflow-hidden">
        
        <!-- å·¦ä¾§ï¼šæ§åˆ¶é¢æ¿ (å¯æ»šåŠ¨) -->
        <div class="w-1/3 flex flex-col gap-4 overflow-y-auto pr-2 custom-scrollbar">
            
            <!-- Nuclei æ§åˆ¶å¡ç‰‡ -->
            <div class="bg-slate-800 rounded-lg shadow-lg border border-slate-700 overflow-hidden shrink-0">
                <!-- Header -->
                <div class="p-4 bg-slate-800 hover:bg-slate-700 cursor-pointer flex justify-between items-center transition" onclick="toggleCard('nuclei-body', 'nuclei-icon')">
                    <div class="flex items-center gap-2">
                        <span id="nuclei-icon" class="text-slate-400 transition-transform duration-200 -rotate-90">â–¼</span>
                        <h2 class="text-lg font-bold text-yellow-400 font-mono">æ¼æ´æ‰«æå™¨ (Nuclei)</h2>
                    </div>
                    <span id="scanBadge" class="hidden px-2 py-0.5 bg-green-600 text-white text-xs rounded animate-pulse">RUNNING</span>
                </div>
                
                <!-- Body -->
                <div id="nuclei-body" class="hidden p-5 pt-0 border-t border-slate-700/50">
                    <div class="space-y-3 mt-3">
                        <input type="text" id="targetInput" placeholder="ç›®æ ‡ (å¯é€‰, ä¾‹: http://192.168.1.1)" 
                               class="w-full bg-slate-900 text-green-400 border border-slate-600 p-2 rounded focus:outline-none focus:border-blue-500 terminal-font text-sm">
                        
                        <input type="text" id="argsInput" placeholder="è‡ªå®šä¹‰å‚æ•° (ä¾‹: -t cves/ -rl 50 -debug)" 
                               class="w-full bg-slate-900 text-yellow-400 border border-slate-600 p-2 rounded focus:outline-none focus:border-blue-500 terminal-font text-sm">

                        <div class="flex gap-2">
                            <button id="btnStart" onclick="startNuclei()" 
                                    class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded transition text-sm shadow-lg">
                                æ‰§è¡Œå‘½ä»¤
                            </button>
                            
                            <button id="btnPing" onclick="startPing()" 
                                    class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded transition text-sm shadow-lg">
                                Ping
                            </button>

                            <button id="btnStop" onclick="stopNuclei()" disabled
                                    class="w-24 bg-red-900 text-slate-400 font-bold py-2 px-4 rounded transition text-sm cursor-not-allowed border border-red-800">
                                åœæ­¢
                            </button>
                        </div>
                        
                        <!-- Nuclei å¸®åŠ©æ–‡æ¡£ (æŠ˜å ) -->
                        <div class="mt-4 border-t border-slate-700 pt-2">
                             <div class="cursor-pointer flex items-center gap-2 text-slate-400 hover:text-white transition text-xs" onclick="toggleCard('nuclei-help-body', 'nuclei-help-icon')">
                                <span id="nuclei-help-icon" class="transition-transform duration-200 -rotate-90">â–¼</span>
                                <span>å®Œæ•´å‘½ä»¤é€ŸæŸ¥ (Full Help)</span>
                             </div>
                             <div id="nuclei-help-body" class="hidden mt-2 p-2 bg-slate-900 rounded border border-slate-700 text-xs text-slate-400 font-mono h-96 overflow-y-auto">
                                 
                                 <div class="mb-3">
                                     <h3 class="text-yellow-500 font-bold border-b border-slate-700 mb-1">[ç›®æ ‡ Target]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-u, -target</td><td>æŒ‡å®šå•ä¸ªç›®æ ‡ URL/ä¸»æœº</td></tr>
                                         <tr><td class="text-green-400">-l, -list</td><td>ä»æ–‡ä»¶åŠ è½½ç›®æ ‡åˆ—è¡¨ (ä¸€è¡Œä¸€ä¸ª)</td></tr>
                                         <tr><td class="text-green-400">-resume</td><td>æ¢å¤ä¹‹å‰çš„æ‰«æ (æŒ‡å®šæ¢å¤æ–‡ä»¶)</td></tr>
                                         <tr><td class="text-green-400">-sa</td><td>æ‰«ææ‰€æœ‰å…³è”çš„ DNS IP</td></tr>
                                         <tr><td class="text-green-400">-iv</td><td>æŒ‡å®š IP ç‰ˆæœ¬ (4 æˆ– 6)</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-yellow-500 font-bold border-b border-slate-700 mb-1">[æ¨¡æ¿ Templates]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-t, -templates</td><td>æŒ‡å®šæ¨¡æ¿æˆ–ç›®å½• (å¦‚ cves/, files/git-core.yaml)</td></tr>
                                         <tr><td class="text-green-400">-nt</td><td>ä»…è¿è¡Œæœ€æ–°å‘å¸ƒçš„æ¨¡æ¿</td></tr>
                                         <tr><td class="text-green-400">-w, -workflows</td><td>è¿è¡Œå·¥ä½œæµ</td></tr>
                                         <tr><td class="text-green-400">-as</td><td>è‡ªåŠ¨æ‰«æ (åŸºäº Wappalyzer æŠ€æœ¯è¯†åˆ«è‡ªåŠ¨é€‰æ‹©æ¨¡æ¿)</td></tr>
                                         <tr><td class="text-green-400">-validate</td><td>éªŒè¯æ¨¡æ¿è¯­æ³•æ˜¯å¦æ­£ç¡®</td></tr>
                                         <tr><td class="text-green-400">-tl</td><td>åˆ—å‡ºæ‰€æœ‰åŒ¹é…å½“å‰è¿‡æ»¤æ¡ä»¶çš„æ¨¡æ¿</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-yellow-500 font-bold border-b border-slate-700 mb-1">[è¿‡æ»¤ Filtering]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-tags</td><td>æŒ‰æ ‡ç­¾åŒ…å« (ä¾‹: cve,xss,jira)</td></tr>
                                         <tr><td class="text-green-400">-etags</td><td>æŒ‰æ ‡ç­¾æ’é™¤</td></tr>
                                         <tr><td class="text-green-400">-s, -severity</td><td>æŒ‰ä¸¥é‡æ€§åŒ…å« (info,low,medium,high,critical)</td></tr>
                                         <tr><td class="text-green-400">-es</td><td>æŒ‰ä¸¥é‡æ€§æ’é™¤</td></tr>
                                         <tr><td class="text-green-400">-pt, -type</td><td>æŒ‰åè®®ç±»å‹ (http, dns, tcp, file, ...)</td></tr>
                                         <tr><td class="text-green-400">-a, -author</td><td>æŒ‰ä½œè€…æ‰§è¡Œ</td></tr>
                                         <tr><td class="text-green-400">-id</td><td>æŒ‰æ¨¡æ¿ ID æ‰§è¡Œ (æ”¯æŒé€šé…ç¬¦)</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-yellow-500 font-bold border-b border-slate-700 mb-1">[è¾“å‡º Output]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-o, -output</td><td>ç»“æœè¾“å‡ºåˆ°æ–‡ä»¶</td></tr>
                                         <tr><td class="text-green-400">-j, -jsonl</td><td>ä»¥ JSONL æ ¼å¼è¾“å‡º</td></tr>
                                         <tr><td class="text-green-400">-nc, -no-color</td><td>ç¦ç”¨é¢œè‰² (è„šæœ¬å¤„ç†æ¨è)</td></tr>
                                         <tr><td class="text-green-400">-silent</td><td>é™é»˜æ¨¡å¼ (ä»…æ˜¾ç¤ºç»“æœï¼Œæ— è¿›åº¦æ¡)</td></tr>
                                         <tr><td class="text-green-400">-v, -verbose</td><td>æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ (è¯·æ±‚/å“åº”)</td></tr>
                                         <tr><td class="text-green-400">-debug</td><td>è°ƒè¯•æ¨¡å¼ (æ˜¾ç¤ºæ‰€æœ‰è¯·æ±‚å“åº”æµé‡)</td></tr>
                                         <tr><td class="text-green-400">-me</td><td>å¯¼å‡ºä¸º Markdown æŠ¥å‘Š</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-yellow-500 font-bold border-b border-slate-700 mb-1">[é…ç½® Config]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-config</td><td>æŒ‡å®šé…ç½®æ–‡ä»¶è·¯å¾„</td></tr>
                                         <tr><td class="text-green-400">-fr</td><td>è·Ÿéš HTTP é‡å®šå‘</td></tr>
                                         <tr><td class="text-green-400">-mr</td><td>æœ€å¤§é‡å®šå‘æ¬¡æ•° (é»˜è®¤ 10)</td></tr>
                                         <tr><td class="text-green-400">-H, -header</td><td>æ·»åŠ è‡ªå®šä¹‰ Header (key:value)</td></tr>
                                         <tr><td class="text-green-400">-p, -proxy</td><td>ä½¿ç”¨ä»£ç† (http/socks5)</td></tr>
                                         <tr><td class="text-green-400">-si, -stats-interval</td><td>ç»Ÿè®¡ä¿¡æ¯æ˜¾ç¤ºé—´éš” (ç§’)</td></tr>
                                         <tr><td class="text-green-400">-stats</td><td>æ˜¾ç¤ºæ‰«æç»Ÿè®¡ä¿¡æ¯</td></tr>
                                     </table>
                                 </div>
                                 
                                 <div class="mb-3">
                                     <h3 class="text-yellow-500 font-bold border-b border-slate-700 mb-1">[é€Ÿç‡ Rate-Limit]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-rl</td><td>æ¯ç§’æœ€å¤§è¯·æ±‚æ•° (é»˜è®¤ 150)</td></tr>
                                         <tr><td class="text-green-400">-rlm</td><td>æ¯åˆ†é’Ÿæœ€å¤§è¯·æ±‚æ•°</td></tr>
                                         <tr><td class="text-green-400">-c</td><td>æ¨¡æ¿å¹¶å‘æ•° (é»˜è®¤ 25)</td></tr>
                                         <tr><td class="text-green-400">-bs</td><td>æ¯ä¸ªæ¨¡æ¿çš„æ‰¹é‡ä¸»æœºæ•° (é»˜è®¤ 25)</td></tr>
                                         <tr><td class="text-green-400">-timeout</td><td>è¶…æ—¶æ—¶é—´ (ç§’, é»˜è®¤ 10)</td></tr>
                                         <tr><td class="text-green-400">-retries</td><td>é‡è¯•æ¬¡æ•° (é»˜è®¤ 1)</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-yellow-500 font-bold border-b border-slate-700 mb-1">[æ›´æ–° Update]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-up, -update</td><td>æ›´æ–° Nuclei å¼•æ“åˆ°æœ€æ–°ç‰ˆ</td></tr>
                                         <tr><td class="text-green-400">-ut</td><td>æ›´æ–°æ¨¡æ¿åº“ (Nuclei Templates)</td></tr>
                                         <tr><td class="text-green-400">-ud</td><td>æŒ‡å®šæ¨¡æ¿å®‰è£…/æ›´æ–°ç›®å½•</td></tr>
                                         <tr><td class="text-green-400">-duc</td><td>ç¦ç”¨è‡ªåŠ¨æ›´æ–°æ£€æŸ¥</td></tr>
                                     </table>
                                 </div>
                                 
                                 <div class="mb-3">
                                     <h3 class="text-yellow-500 font-bold border-b border-slate-700 mb-1">[å…¶ä»– Others]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-ni, -no-interactsh</td><td>ç¦ç”¨ Interactsh (OAST) åŠŸèƒ½</td></tr>
                                         <tr><td class="text-green-400">-iserver</td><td>æŒ‡å®šè‡ªå»ºçš„ Interactsh æœåŠ¡å™¨</td></tr>
                                         <tr><td class="text-green-400">-headless</td><td>å¯ç”¨æ— å¤´æµè§ˆå™¨æ¨¡å¼ (éœ€å®‰è£… Chrome)</td></tr>
                                         <tr><td class="text-green-400">-health-check</td><td>è¿è¡Œå¥åº·æ£€æŸ¥</td></tr>
                                     </table>
                                 </div>

                             </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Nmap æ§åˆ¶å¡ç‰‡ -->
            <div class="bg-slate-800 rounded-lg shadow-lg border border-slate-700 overflow-hidden shrink-0">
                <div class="p-4 bg-slate-800 hover:bg-slate-700 cursor-pointer flex justify-between items-center transition" onclick="toggleCard('nmap-body', 'nmap-icon')">
                    <div class="flex items-center gap-2">
                        <span id="nmap-icon" class="text-slate-400 transition-transform duration-200 -rotate-90">â–¼</span>
                        <h2 class="text-lg font-bold text-indigo-400 font-mono">ç«¯å£æ‰«æå™¨ (Nmap)</h2>
                    </div>
                    <span id="nmapBadge" class="hidden px-2 py-0.5 bg-indigo-600 text-white text-xs rounded animate-pulse">RUNNING</span>
                </div>
                
                <div id="nmap-body" class="hidden p-5 pt-0 border-t border-slate-700/50">
                    <div class="space-y-3 mt-3">
                        <input type="text" id="nmapTargetInput" placeholder="ç›®æ ‡ IP/åŸŸå (ä¾‹: 192.168.1.1)" 
                               class="w-full bg-slate-900 text-indigo-400 border border-slate-600 p-2 rounded focus:outline-none focus:border-blue-500 terminal-font text-sm">
                        
                        <input type="text" id="nmapArgsInput" placeholder="è‡ªå®šä¹‰å‚æ•° (ä¾‹: -sV -p 1-1000)" 
                               class="w-full bg-slate-900 text-yellow-400 border border-slate-600 p-2 rounded focus:outline-none focus:border-blue-500 terminal-font text-sm">

                        <div class="flex gap-2">
                            <button id="btnNmapStart" onclick="startNmap()" 
                                    class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded transition text-sm shadow-lg">
                                å¯åŠ¨ Nmap æ‰«æ
                            </button>
                             <button id="btnNmapStop" onclick="stopTask('nmap')" disabled
                                    class="w-24 bg-red-900 text-slate-400 font-bold py-2 px-4 rounded transition text-sm cursor-not-allowed border border-red-800">
                                åœæ­¢
                            </button>
                        </div>
                        
                        <!-- æ‹“æ‰‘å›¾æŒ‰é’® -->
                        <div class="mt-2">
                            <button onclick="window.location.href='/topology'" 
                                    class="w-full bg-slate-700 hover:bg-slate-600 text-indigo-300 font-bold py-2 px-4 rounded transition text-xs border border-slate-600 flex items-center justify-center gap-2">
                                <span>ğŸ•¸ï¸</span>
                                <span>æŸ¥çœ‹ç½‘ç»œæ‹“æ‰‘å›¾ (View Topology)</span>
                            </button>
                        </div>

                        <!-- Nmap å¸®åŠ©æ–‡æ¡£ (æŠ˜å ) -->
                        <div class="mt-4 border-t border-slate-700 pt-2">
                             <div class="cursor-pointer flex items-center gap-2 text-slate-400 hover:text-white transition text-xs" onclick="toggleCard('nmap-help-body', 'nmap-help-icon')">
                                <span id="nmap-help-icon" class="transition-transform duration-200 -rotate-90">â–¼</span>
                                <span>å®Œæ•´å‘½ä»¤é€ŸæŸ¥ (Full Help)</span>
                             </div>
                             <div id="nmap-help-body" class="hidden mt-2 p-2 bg-slate-900 rounded border border-slate-700 text-xs text-slate-400 font-mono h-96 overflow-y-auto">
                                 
                                 <div class="mb-3">
                                     <h3 class="text-indigo-400 font-bold border-b border-slate-700 mb-1">[ç›®æ ‡ Target]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">IP/åŸŸå</td><td>ç›´æ¥è¾“å…¥ (ä¾‹: 192.168.1.1, scanme.nmap.org)</td></tr>
                                         <tr><td class="text-green-400">CIDR</td><td>ç½‘æ®µæ‰«æ (ä¾‹: 192.168.1.0/24)</td></tr>
                                         <tr><td class="text-green-400">-iL &lt;file&gt;</td><td>ä»æ–‡ä»¶å¯¼å…¥ç›®æ ‡åˆ—è¡¨</td></tr>
                                         <tr><td class="text-green-400">-iR &lt;num&gt;</td><td>éšæœºé€‰æ‹© &lt;num&gt; ä¸ªç›®æ ‡</td></tr>
                                         <tr><td class="text-green-400">--exclude</td><td>æ’é™¤ç›®æ ‡ (ä¾‹: --exclude 192.168.1.5)</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-indigo-400 font-bold border-b border-slate-700 mb-1">[ä¸»æœºå‘ç° Host Discovery]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-sn</td><td>Ping æ‰«æ (ä¸æ‰«ç«¯å£ï¼Œåªçœ‹å­˜æ´»)</td></tr>
                                         <tr><td class="text-green-400">-Pn</td><td>è·³è¿‡ Ping (å‡è®¾æ‰€æœ‰ç›®æ ‡åœ¨çº¿ï¼Œå¼ºåˆ¶æ‰«æ)</td></tr>
                                         <tr><td class="text-green-400">-PS/PA/PU</td><td>ä½¿ç”¨ TCP SYN/ACK æˆ– UDP åŒ…æ¢æµ‹</td></tr>
                                         <tr><td class="text-green-400">-n / -R</td><td>ä¸è§£æ DNS / æ€»æ˜¯è§£æ DNS</td></tr>
                                         <tr><td class="text-green-400">--traceroute</td><td>æ¢æµ‹è·¯ç”±è·¯å¾„</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-indigo-400 font-bold border-b border-slate-700 mb-1">[æ‰«ææŠ€æœ¯ Scan Techniques]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-sS</td><td>TCP SYN æ‰«æ (åŠå¼€æ”¾ï¼Œéœ€ Rootï¼Œæœ€å¸¸ç”¨/éšè”½)</td></tr>
                                         <tr><td class="text-green-400">-sT</td><td>TCP Connect æ‰«æ (å…¨è¿æ¥ï¼Œæ— éœ€ Root)</td></tr>
                                         <tr><td class="text-green-400">-sU</td><td>UDP æ‰«æ (æ…¢ï¼Œæ¢æµ‹ UDP æœåŠ¡)</td></tr>
                                         <tr><td class="text-green-400">-sA</td><td>ACK æ‰«æ (ç”¨äºæ¢æµ‹é˜²ç«å¢™è§„åˆ™)</td></tr>
                                         <tr><td class="text-green-400">-sI &lt;zombie&gt;</td><td>Idle æ‰«æ (åˆ©ç”¨åƒµå°¸ä¸»æœºè¿›è¡Œéšè”½æ‰«æ)</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-indigo-400 font-bold border-b border-slate-700 mb-1">[ç«¯å£ä¸æœåŠ¡ Port/Service]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-p &lt;ports&gt;</td><td>æŒ‡å®šç«¯å£ (ä¾‹: -p 80,443 æˆ– -p 1-65535)</td></tr>
                                         <tr><td class="text-green-400">-F</td><td>å¿«é€Ÿæ‰«æ (ä»…å‰ 100 ä¸ªå¸¸ç”¨ç«¯å£)</td></tr>
                                         <tr><td class="text-green-400">-r</td><td>é¡ºåºæ‰«æç«¯å£ (é»˜è®¤éšæœº)</td></tr>
                                         <tr><td class="text-green-400">-sV</td><td>æ¢æµ‹æœåŠ¡/ç‰ˆæœ¬ä¿¡æ¯</td></tr>
                                         <tr><td class="text-green-400">--version-light</td><td>è½»é‡çº§ç‰ˆæœ¬æ¢æµ‹ (é€Ÿåº¦å¿«)</td></tr>
                                         <tr><td class="text-green-400">--version-all</td><td>å°è¯•æ‰€æœ‰æ¢é’ˆ (æœ€ç²¾ç¡®ä½†æ…¢)</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-indigo-400 font-bold border-b border-slate-700 mb-1">[ç³»ç»Ÿä¸è„šæœ¬ OS/Script]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-O</td><td>å¯ç”¨æ“ä½œç³»ç»Ÿæ¢æµ‹ (éœ€ Root)</td></tr>
                                         <tr><td class="text-green-400">--osscan-guess</td><td>æ›´æ¿€è¿›åœ°çŒœæµ‹ OS</td></tr>
                                         <tr><td class="text-green-400">-sC</td><td>ä½¿ç”¨é»˜è®¤è„šæœ¬é›† (ç­‰åŒ --script=default)</td></tr>
                                         <tr><td class="text-green-400">--script</td><td>æŒ‡å®šè„šæœ¬ (ä¾‹: --script=vuln,auth)</td></tr>
                                         <tr><td class="text-green-400">--script-args</td><td>ä¼ é€’å‚æ•°ç»™è„šæœ¬</td></tr>
                                         <tr><td class="text-green-400">-A</td><td>ç»¼åˆæ‰«æ (OS + ç‰ˆæœ¬ + è„šæœ¬ + è·¯ç”±)</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-indigo-400 font-bold border-b border-slate-700 mb-1">[æ€§èƒ½ Timing]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-T&lt;0-5&gt;</td><td>é€Ÿåº¦æ¨¡æ¿ (T4 æ¨èï¼ŒT5 æé€Ÿæ˜“ä¸¢åŒ…)</td></tr>
                                         <tr><td class="text-green-400">--min-rate</td><td>æœ€å°å‘åŒ…é€Ÿç‡ (ä¾‹: --min-rate 1000)</td></tr>
                                         <tr><td class="text-green-400">--max-retries</td><td>æœ€å¤§é‡è¯•æ¬¡æ•° (å‡å°‘å¯åŠ é€Ÿ)</td></tr>
                                         <tr><td class="text-green-400">--host-timeout</td><td>å•ä¸»æœºè¶…æ—¶æ”¾å¼ƒæ—¶é—´</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-indigo-400 font-bold border-b border-slate-700 mb-1">[é˜²ç«å¢™è§„é¿ Firewall]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-f</td><td>æŠ¥æ–‡åˆ†ç‰‡ (Fragment)</td></tr>
                                         <tr><td class="text-green-400">-D</td><td>ä½¿ç”¨è¯±é¥µ IP (Decoy, ä¾‹: -D 1.1.1.1,ME)</td></tr>
                                         <tr><td class="text-green-400">-S</td><td>ä¼ªé€ æº IP åœ°å€</td></tr>
                                         <tr><td class="text-green-400">-g / --source-port</td><td>æŒ‡å®šæºç«¯å£ (ä¾‹: -g 53 ç»•è¿‡é˜²ç«å¢™)</td></tr>
                                         <tr><td class="text-green-400">--proxies</td><td>ä½¿ç”¨ HTTP/SOCKS4 ä»£ç†</td></tr>
                                         <tr><td class="text-green-400">--spoof-mac</td><td>ä¼ªé€  MAC åœ°å€</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-indigo-400 font-bold border-b border-slate-700 mb-1">[è¾“å‡º Output]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-oN</td><td>æ ‡å‡†æ ¼å¼ä¿å­˜åˆ°æ–‡ä»¶</td></tr>
                                         <tr><td class="text-green-400">-oX</td><td>XML æ ¼å¼ä¿å­˜ (ä¾¿äºç¨‹åºè§£æ)</td></tr>
                                         <tr><td class="text-green-400">-oG</td><td>Grepable æ ¼å¼ (ä¾¿äº grep)</td></tr>
                                         <tr><td class="text-green-400">-oA</td><td>åŒæ—¶ä¿å­˜ä¸‰ç§æ ¼å¼ (N, X, G)</td></tr>
                                         <tr><td class="text-green-400">-v</td><td>å¢åŠ è¾“å‡ºè¯¦ç»†ç¨‹åº¦ (-vv æ›´è¯¦ç»†)</td></tr>
                                         <tr><td class="text-green-400">--open</td><td>ä»…æ˜¾ç¤ºå¼€æ”¾çš„ç«¯å£</td></tr>
                                         <tr><td class="text-green-400">--reason</td><td>æ˜¾ç¤ºç«¯å£å¤„äºè¯¥çŠ¶æ€çš„åŸå› </td></tr>
                                     </table>
                                 </div>
                                 
                                 <div class="mb-3">
                                     <h3 class="text-indigo-400 font-bold border-b border-slate-700 mb-1">[å…¶ä»– Misc]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-6</td><td>å¯ç”¨ IPv6 æ‰«æ</td></tr>
                                         <tr><td class="text-green-400">--privileged</td><td>å¼ºåˆ¶å‡è®¾æœ‰å®Œæ•´æƒé™</td></tr>
                                         <tr><td class="text-green-400">-V</td><td>æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯</td></tr>
                                         <tr><td class="text-green-400">-h</td><td>æ˜¾ç¤ºå¸®åŠ©</td></tr>
                                     </table>
                                 </div>

                             </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Fscan æ§åˆ¶å¡ç‰‡ -->
            <div class="bg-slate-800 rounded-lg shadow-lg border border-slate-700 overflow-hidden shrink-0">
                <div class="p-4 bg-slate-800 hover:bg-slate-700 cursor-pointer flex justify-between items-center transition" onclick="toggleCard('fscan-body', 'fscan-icon')">
                    <div class="flex items-center gap-2">
                        <span id="fscan-icon" class="text-slate-400 transition-transform duration-200 -rotate-90">â–¼</span>
                        <h2 class="text-lg font-bold text-red-400 font-mono">å†…ç½‘æ¼æ‰« (Fscan)</h2>
                    </div>
                    <span id="fscanBadge" class="hidden px-2 py-0.5 bg-red-600 text-white text-xs rounded animate-pulse">RUNNING</span>
                </div>
                
                <div id="fscan-body" class="hidden p-5 pt-0 border-t border-slate-700/50">
                    <div class="space-y-3 mt-3">
                        <input type="text" id="fscanTargetInput" placeholder="ç›®æ ‡ IP/CIDR (ä¾‹: 192.168.1.1/24)" 
                               class="w-full bg-slate-900 text-red-400 border border-slate-600 p-2 rounded focus:outline-none focus:border-blue-500 terminal-font text-sm">
                        
                        <input type="text" id="fscanArgsInput" placeholder="è‡ªå®šä¹‰å‚æ•° (ä¾‹: -nopoc -t 600)" 
                               class="w-full bg-slate-900 text-yellow-400 border border-slate-600 p-2 rounded focus:outline-none focus:border-blue-500 terminal-font text-sm">

                        <div class="flex gap-2">
                            <button id="btnFscanStart" onclick="startFscan()" 
                                    class="flex-1 bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded transition text-sm shadow-lg">
                                å¯åŠ¨ Fscan æ‰«æ
                            </button>
                            <button id="btnFscanStop" onclick="stopTask('fscan')" disabled
                                    class="w-24 bg-red-900 text-slate-400 font-bold py-2 px-4 rounded transition text-sm cursor-not-allowed border border-red-800">
                                åœæ­¢
                            </button>
                        </div>

                        <!-- Fscan å¸®åŠ©æ–‡æ¡£ (æŠ˜å ) -->
                        <div class="mt-4 border-t border-slate-700 pt-2">
                             <div class="cursor-pointer flex items-center gap-2 text-slate-400 hover:text-white transition text-xs" onclick="toggleCard('fscan-help-body', 'fscan-help-icon')">
                                <span id="fscan-help-icon" class="transition-transform duration-200 -rotate-90">â–¼</span>
                                <span>å®Œæ•´å‘½ä»¤é€ŸæŸ¥ (Full Help)</span>
                             </div>
                             <div id="fscan-help-body" class="hidden mt-2 p-2 bg-slate-900 rounded border border-slate-700 text-xs text-slate-400 font-mono h-64 overflow-y-auto">
                                 
                                 <div class="mb-3">
                                     <h3 class="text-red-400 font-bold border-b border-slate-700 mb-1">[æ ¸å¿ƒä¸ç›®æ ‡ Core/Target]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-h</td><td>ç›®æ ‡ IP (192.168.1.1/24, 1.1.1.1-255)</td></tr>
                                         <tr><td class="text-green-400">-hf &lt;file&gt;</td><td>ä»æ–‡ä»¶è¯»å–ç›®æ ‡åˆ—è¡¨</td></tr>
                                         <tr><td class="text-green-400">-hn</td><td>æ’é™¤ç‰¹å®š IP (ä¸æ‰«æ)</td></tr>
                                         <tr><td class="text-green-400">-u / -uf</td><td>æŒ‡å®š URL / URL æ–‡ä»¶</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-red-400 font-bold border-b border-slate-700 mb-1">[ç«¯å£é…ç½® Port]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-p</td><td>æŒ‡å®šç«¯å£ (22,80, 1-65535)</td></tr>
                                         <tr><td class="text-green-400">-pa</td><td>åœ¨é»˜è®¤ç«¯å£åŸºç¡€ä¸Šè¿½åŠ ç«¯å£</td></tr>
                                         <tr><td class="text-green-400">-pn</td><td>æ’é™¤ç‰¹å®šç«¯å£ (ä¸æ‰«æ)</td></tr>
                                         <tr><td class="text-green-400">-portf</td><td>ä»æ–‡ä»¶è¯»å–ç«¯å£åˆ—è¡¨</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-red-400 font-bold border-b border-slate-700 mb-1">[æ‰«ææ¨¡å¼ Mode]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-m</td><td>æŒ‡å®šæ¨¡å¼ (ssh, poc, mssql, redis, all...)</td></tr>
                                         <tr><td class="text-green-400">-np</td><td>è·³è¿‡ Ping å­˜æ´»æ¢æµ‹</td></tr>
                                         <tr><td class="text-green-400">-ping</td><td>ä½¿ç”¨ Ping ä»£æ›¿ ICMP</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-red-400 font-bold border-b border-slate-700 mb-1">[æ¼æ´æ¢æµ‹ POC]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-nopoc</td><td>è·³è¿‡ Web æ¼æ´æ‰«æ</td></tr>
                                         <tr><td class="text-green-400">-pocname</td><td>æŒ‡å®šç‰¹å®š POC (å¦‚ weblogic)</td></tr>
                                         <tr><td class="text-green-400">-pocpath</td><td>åŠ è½½è‡ªå®šä¹‰ POC æ–‡ä»¶è·¯å¾„</td></tr>
                                         <tr><td class="text-green-400">-full</td><td>å®Œæ•´ POC æ‰«æ (å¦‚ Shiro 100 Key)</td></tr>
                                         <tr><td class="text-green-400">-dns</td><td>ä½¿ç”¨ DNSLog éªŒè¯æ¼æ´</td></tr>
                                         <tr><td class="text-green-400">-cookie</td><td>è®¾ç½®æ‰«ææ—¶çš„ Cookie</td></tr>
                                         <tr><td class="text-green-400">-proxy</td><td>è®¾ç½® HTTP ä»£ç†</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-red-400 font-bold border-b border-slate-700 mb-1">[æš´åŠ›ç ´è§£ Brute]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-nobr</td><td>è·³è¿‡å¼±å£ä»¤çˆ†ç ´</td></tr>
                                         <tr><td class="text-green-400">-br</td><td>çˆ†ç ´çº¿ç¨‹æ•° (é»˜è®¤ 1)</td></tr>
                                         <tr><td class="text-green-400">-user / -pwd</td><td>æŒ‡å®šç‰¹å®šç”¨æˆ·å/å¯†ç </td></tr>
                                         <tr><td class="text-green-400">-userf / -pwdf</td><td>æŒ‡å®šç”¨æˆ·å/å¯†ç å­—å…¸æ–‡ä»¶</td></tr>
                                         <tr><td class="text-green-400">-usera / -pwda</td><td>è¿½åŠ ç”¨æˆ·å/å¯†ç åˆ°é»˜è®¤å­—å…¸</td></tr>
                                         <tr><td class="text-green-400">-sshkey</td><td>æŒ‡å®š SSH ç§é’¥æ–‡ä»¶</td></tr>
                                         <tr><td class="text-green-400">-domain</td><td>æŒ‡å®š SMB åŸŸå</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-red-400 font-bold border-b border-slate-700 mb-1">[é…ç½®ä¸è¾“å‡º Config]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-o</td><td>æŒ‡å®šè¾“å‡ºæ–‡ä»¶ (é»˜è®¤ result.txt)</td></tr>
                                         <tr><td class="text-green-400">-no</td><td>ä¸ä¿å­˜æ–‡ä»¶ (ä»…å±å¹•è¾“å‡º)</td></tr>
                                         <tr><td class="text-green-400">-json</td><td>JSON æ ¼å¼è¾“å‡º</td></tr>
                                         <tr><td class="text-green-400">-t</td><td>æ‰«æçº¿ç¨‹æ•° (é»˜è®¤ 600)</td></tr>
                                         <tr><td class="text-green-400">-time</td><td>ç½‘ç»œè¶…æ—¶æ—¶é—´ (é»˜è®¤ 3ç§’)</td></tr>
                                         <tr><td class="text-green-400">-wt</td><td>Web è®¿é—®è¶…æ—¶æ—¶é—´ (é»˜è®¤ 5ç§’)</td></tr>
                                         <tr><td class="text-green-400">-silent</td><td>é™é»˜æ¨¡å¼ (å‡å°‘è¾“å‡º)</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-red-400 font-bold border-b border-slate-700 mb-1">[é«˜çº§åˆ©ç”¨ Exploit]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-c</td><td>æ‰§è¡Œå‘½ä»¤ (ssh|wmiexec)</td></tr>
                                         <tr><td class="text-green-400">-rs</td><td>Redis å†™ Shell (ip:port)</td></tr>
                                         <tr><td class="text-green-400">-rf</td><td>Redis å†™ SSH å…¬é’¥</td></tr>
                                         <tr><td class="text-green-400">-sc</td><td>MS17-010 Shellcode (add user)</td></tr>
                                         <tr><td class="text-green-400">-wmi</td><td>å¯ç”¨ WMI åˆ©ç”¨</td></tr>
                                     </table>
                                 </div>

                             </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Feroxbuster æ§åˆ¶å¡ç‰‡ -->
            <div class="bg-slate-800 rounded-lg shadow-lg border border-slate-700 overflow-hidden shrink-0">
                <div class="p-4 bg-slate-800 hover:bg-slate-700 cursor-pointer flex justify-between items-center transition" onclick="toggleCard('feroxbuster-body', 'feroxbuster-icon')">
                    <div class="flex items-center gap-2">
                        <span id="feroxbuster-icon" class="text-slate-400 transition-transform duration-200 -rotate-90">â–¼</span>
                        <h2 class="text-lg font-bold text-cyan-400 font-mono">ç›®å½•çˆ†ç ´ (Feroxbuster)</h2>
                    </div>
                    <span id="feroxbusterBadge" class="hidden px-2 py-0.5 bg-cyan-600 text-white text-xs rounded animate-pulse">RUNNING</span>
                </div>

                <div id="feroxbuster-body" class="hidden p-5 pt-0 border-t border-slate-700/50">
                    <div class="space-y-3 mt-3">
                        <input type="text" id="feroxbusterTargetInput" placeholder="ç›®æ ‡ URL (ä¾‹: http://192.168.1.1)"
                               class="w-full bg-slate-900 text-cyan-400 border border-slate-600 p-2 rounded focus:outline-none focus:border-blue-500 terminal-font text-sm">

                        <input type="text" id="feroxbusterArgsInput" placeholder="è‡ªå®šä¹‰å‚æ•° (ä¾‹: -w /path/to/wordlist.txt -x php,html -t 50)"
                               class="w-full bg-slate-900 text-yellow-400 border border-slate-600 p-2 rounded focus:outline-none focus:border-blue-500 terminal-font text-sm">

                        <div class="flex gap-2">
                            <button id="btnFeroxbusterStart" onclick="startFeroxbuster()"
                                    class="flex-1 bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-2 px-4 rounded transition text-sm shadow-lg">
                                å¯åŠ¨ Feroxbuster æ‰«æ
                            </button>
                             <button id="btnFeroxbusterStop" onclick="stopTask('feroxbuster')" disabled
                                    class="w-24 bg-red-900 text-slate-400 font-bold py-2 px-4 rounded transition text-sm cursor-not-allowed border border-red-800">
                                åœæ­¢
                            </button>
                        </div>

                        <!-- Feroxbuster å¸®åŠ©æ–‡æ¡£ (æŠ˜å ) -->
                        <div class="mt-4 border-t border-slate-700 pt-2">
                             <div class="cursor-pointer flex items-center gap-2 text-slate-400 hover:text-white transition text-xs" onclick="toggleCard('feroxbuster-help-body', 'feroxbuster-help-icon')">
                                <span id="feroxbuster-help-icon" class="transition-transform duration-200 -rotate-90">â–¼</span>
                                <span>å®Œæ•´å‘½ä»¤é€ŸæŸ¥ (Full Help)</span>
                             </div>
                             <div id="feroxbuster-help-body" class="hidden mt-2 p-2 bg-slate-900 rounded border border-slate-700 text-xs text-slate-400 font-mono h-64 overflow-y-auto">

                                 <div class="mb-3">
                                     <h3 class="text-cyan-400 font-bold border-b border-slate-700 mb-1">[ç›®æ ‡ Target]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-u, --url</td><td>ç›®æ ‡ URL (ä¾‹: -u http://target.com)</td></tr>
                                         <tr><td class="text-green-400">--url-scan</td><td>ä»æ–‡ä»¶è¯»å– URL åˆ—è¡¨</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-cyan-400 font-bold border-b border-slate-700 mb-1">[å­—å…¸ Wordlist]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-w</td><td>æŒ‡å®šå­—å…¸æ–‡ä»¶ (ä¾‹: -w /usr/share/wordlists/dirb/common.txt)</td></tr>
                                         <tr><td class="text-green-400">-e, --extensions</td><td>æ–‡ä»¶æ‰©å±•å (ä¾‹: -x php,asp,aspx,jsp)</td></tr>
                                         <tr><td class="text-green-400">-n, --no-recursion</td><td>ç¦ç”¨é€’å½’æ‰«æ</td></tr>
                                         <tr><td class="text-green-400">--depth</td><td>æœ€å¤§é€’å½’æ·±åº¦ (é»˜è®¤ 4)</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-cyan-400 font-bold border-b border-slate-700 mb-1">[æ€§èƒ½ Performance]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-t, --threads</td><td>å¹¶å‘çº¿ç¨‹æ•° (é»˜è®¤ 50)</td></tr>
                                         <tr><td class="text-green-400">--timeout</td><td>è¯·æ±‚è¶…æ—¶æ—¶é—´ (ç§’, é»˜è®¤ 7)</td></tr>
                                         <tr><td class="text-green-400">-r, --retries</td><td>é‡è¯•æ¬¡æ•° (é»˜è®¤ 3)</td></tr>
                                         <tr><td class="text-green-400">--rate-limit</td><td>é™åˆ¶æ¯ç§’è¯·æ±‚æ•°</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-cyan-400 font-bold border-b border-slate-700 mb-1">[è¿‡æ»¤ Filters]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-s, --status-codes</td><td>æ˜¾ç¤ºçš„çŠ¶æ€ç  (ä¾‹: -s 200,301,302)</td></tr>
                                         <tr><td class="text-green-400">-C, --filter-status</td><td>æ’é™¤çš„çŠ¶æ€ç </td></tr>
                                         <tr><td class="text-green-400">-S, --filter-size</td><td>æ’é™¤æŒ‡å®šå“åº”å¤§å°</td></tr>
                                         <tr><td class="text-green-400">-N, --filter-lines</td><td>æ’é™¤æŒ‡å®šè¡Œæ•°</td></tr>
                                         <tr><td class="text-green-400">--filter-regex</td><td>ä½¿ç”¨æ­£åˆ™è¿‡æ»¤å“åº”å†…å®¹</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-cyan-400 font-bold border-b border-slate-700 mb-1">[è¾“å‡º Output]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-o, --output</td><td>ä¿å­˜ç»“æœåˆ°æ–‡ä»¶</td></tr>
                                         <tr><td class="text-green-400">--json</td><td>ä»¥ JSON æ ¼å¼è¾“å‡º</td></tr>
                                         <tr><td class="text-green-400">-q, --quiet</td><td>é™é»˜æ¨¡å¼ (ä»…æ˜¾ç¤ºç»“æœ)</td></tr>
                                         <tr><td class="text-green-400">-v, --verbosity</td><td>å¢åŠ è¯¦ç»†ç¨‹åº¦ (-v, -vv)</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-cyan-400 font-bold border-b border-slate-700 mb-1">[è¯·æ±‚ Request]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-H, --headers</td><td>æ·»åŠ è¯·æ±‚å¤´ (ä¾‹: -H "Cookie: session=xxx")</td></tr>
                                         <tr><td class="text-green-400">-a, --user-agent</td><td>è‡ªå®šä¹‰ User-Agent</td></tr>
                                         <tr><td class="text-green-400">-x, --proxy</td><td>ä½¿ç”¨ä»£ç† (ä¾‹: -x http://127.0.0.1:8080)</td></tr>
                                         <tr><td class="text-green-400">-k, --insecure</td><td>å¿½ç•¥ SSL è¯ä¹¦éªŒè¯</td></tr>
                                     </table>
                                 </div>

                             </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sqlmap æ§åˆ¶å¡ç‰‡ -->
            <div class="bg-slate-800 rounded-lg shadow-lg border border-slate-700 overflow-hidden shrink-0">
                <div class="p-4 bg-slate-800 hover:bg-slate-700 cursor-pointer flex justify-between items-center transition" onclick="toggleCard('sqlmap-body', 'sqlmap-icon')">
                    <div class="flex items-center gap-2">
                        <span id="sqlmap-icon" class="text-slate-400 transition-transform duration-200 -rotate-90">â–¼</span>
                        <h2 class="text-lg font-bold text-orange-500 font-mono">SQL æ³¨å…¥æ£€æµ‹ (Sqlmap)</h2>
                    </div>
                    <span id="sqlmapBadge" class="hidden px-2 py-0.5 bg-orange-600 text-white text-xs rounded animate-pulse">RUNNING</span>
                </div>
                
                <div id="sqlmap-body" class="hidden p-5 pt-0 border-t border-slate-700/50">
                    <div class="space-y-3 mt-3">
                        <input type="text" id="sqlmapTargetInput" placeholder="ç›®æ ‡ URL (ä¾‹: http://testphp.vulnweb.com/artists.php?artist=1)" 
                               class="w-full bg-slate-900 text-orange-400 border border-slate-600 p-2 rounded focus:outline-none focus:border-blue-500 terminal-font text-sm">
                        
                        <input type="text" id="sqlmapArgsInput" placeholder="è‡ªå®šä¹‰å‚æ•° (ä¾‹: --dbs --batch --random-agent)" 
                               class="w-full bg-slate-900 text-yellow-400 border border-slate-600 p-2 rounded focus:outline-none focus:border-blue-500 terminal-font text-sm">

                        <div class="flex gap-2">
                            <button id="btnSqlmapStart" onclick="startSqlmap()" 
                                    class="flex-1 bg-orange-600 hover:bg-orange-700 text-white font-bold py-2 px-4 rounded transition text-sm shadow-lg">
                                å¯åŠ¨ Sqlmap æ‰«æ
                            </button>
                             <button id="btnSqlmapStop" onclick="stopTask('sqlmap')" disabled
                                    class="w-24 bg-red-900 text-slate-400 font-bold py-2 px-4 rounded transition text-sm cursor-not-allowed border border-red-800">
                                åœæ­¢
                            </button>
                        </div>
                        
                        <!-- Sqlmap å¸®åŠ©æ–‡æ¡£ (æŠ˜å ) -->
                        <div class="mt-4 border-t border-slate-700 pt-2">
                             <div class="cursor-pointer flex items-center gap-2 text-slate-400 hover:text-white transition text-xs" onclick="toggleCard('sqlmap-help-body', 'sqlmap-help-icon')">
                                <span id="sqlmap-help-icon" class="transition-transform duration-200 -rotate-90">â–¼</span>
                                <span>å®Œæ•´å‘½ä»¤é€ŸæŸ¥ (Full Help)</span>
                             </div>
                             <div id="sqlmap-help-body" class="hidden mt-2 p-2 bg-slate-900 rounded border border-slate-700 text-xs text-slate-400 font-mono h-64 overflow-y-auto">
                                 
                                 <div class="mb-3">
                                     <h3 class="text-orange-400 font-bold border-b border-slate-700 mb-1">[ç›®æ ‡ Target]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-u, --url</td><td>æŒ‡å®šç›®æ ‡ URL (ä¾‹: -u "http://site.com/vuln.php?id=1")</td></tr>
                                         <tr><td class="text-green-400">-g</td><td>ä½¿ç”¨ Google Dork æœç´¢ç»“æœä½œä¸ºç›®æ ‡</td></tr>
                                         <tr><td class="text-green-400">-r</td><td>ä» HTTP è¯·æ±‚æ–‡ä»¶åŠ è½½ç›®æ ‡ (éœ€æŠ“åŒ…ä¿å­˜)</td></tr>
                                         <tr><td class="text-green-400">-m</td><td>ä»æ–‡æœ¬æ–‡ä»¶åŠ è½½å¤šä¸ª URL åˆ—è¡¨</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-orange-400 font-bold border-b border-slate-700 mb-1">[è¯·æ±‚ Request]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">--data</td><td>POST æ•°æ® (ä¾‹: "id=1&name=test")</td></tr>
                                         <tr><td class="text-green-400">--cookie</td><td>è®¾ç½® Cookie (ä¾‹: "PHPSESSID=xxx")</td></tr>
                                         <tr><td class="text-green-400">--random-agent</td><td>ä½¿ç”¨éšæœº User-Agent (é˜²æ‹¦æˆª)</td></tr>
                                         <tr><td class="text-green-400">--proxy</td><td>ä½¿ç”¨ä»£ç† (ä¾‹: "http://127.0.0.1:8080")</td></tr>
                                         <tr><td class="text-green-400">--tor</td><td>ä½¿ç”¨ Tor åŒ¿åç½‘ç»œ</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-orange-400 font-bold border-b border-slate-700 mb-1">[æ³¨å…¥ä¸æ£€æµ‹ Injection]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-p</td><td>æŒ‡å®šæµ‹è¯•å‚æ•° (ä¾‹: -p "id,user-agent")</td></tr>
                                         <tr><td class="text-green-400">--dbms</td><td>å¼ºåˆ¶æŒ‡å®šåç«¯æ•°æ®åº“ (å¦‚ MySQL, PostgreSQL)</td></tr>
                                         <tr><td class="text-green-400">--level &lt;1-5&gt;</td><td>æ£€æµ‹ç­‰çº§ (é»˜è®¤1ï¼Œ3çº§æµ‹User-Agentï¼Œ5çº§æœ€å…¨)</td></tr>
                                         <tr><td class="text-green-400">--risk &lt;1-3&gt;</td><td>é£é™©ç­‰çº§ (é»˜è®¤1ï¼Œ3çº§åŒ…å«å±é™©æ“ä½œ)</td></tr>
                                         <tr><td class="text-green-400">--technique</td><td>æŒ‡å®šæŠ€æœ¯ (B:å¸ƒå°”, E:æŠ¥é”™, U:è”åˆ, S:å †å , T:æ—¶é—´, Q:å†…è”)</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-orange-400 font-bold border-b border-slate-700 mb-1">[æšä¸¾ Enumeration]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">-a, --all</td><td>è·å–æ‰€æœ‰ä¿¡æ¯ (å…¨å®¶æ¡¶)</td></tr>
                                         <tr><td class="text-green-400">-b, --banner</td><td>è·å–æ•°æ®åº“ç‰ˆæœ¬ä¿¡æ¯</td></tr>
                                         <tr><td class="text-green-400">--current-user</td><td>è·å–å½“å‰æ•°æ®åº“ç”¨æˆ·</td></tr>
                                         <tr><td class="text-green-400">--current-db</td><td>è·å–å½“å‰æ•°æ®åº“å</td></tr>
                                         <tr><td class="text-green-400">--passwords</td><td>æšä¸¾æ•°æ®åº“ç”¨æˆ·å¯†ç å“ˆå¸Œ</td></tr>
                                         <tr><td class="text-green-400">--dbs</td><td>åˆ—å‡ºæ‰€æœ‰æ•°æ®åº“</td></tr>
                                         <tr><td class="text-green-400">--tables</td><td>åˆ—å‡ºæŒ‡å®šåº“çš„æ‰€æœ‰è¡¨ (éœ€é…åˆ -D)</td></tr>
                                         <tr><td class="text-green-400">--columns</td><td>åˆ—å‡ºæŒ‡å®šè¡¨çš„æ‰€æœ‰åˆ— (éœ€é…åˆ -D -T)</td></tr>
                                         <tr><td class="text-green-400">--dump</td><td>å¯¼å‡ºæ•°æ® (æ‹–åº“)</td></tr>
                                         <tr><td class="text-green-400">-D / -T / -C</td><td>æŒ‡å®š åº“ / è¡¨ / åˆ—</td></tr>
                                     </table>
                                 </div>

                                 <div class="mb-3">
                                     <h3 class="text-orange-400 font-bold border-b border-slate-700 mb-1">[ç³»ç»Ÿè®¿é—® OS Access]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">--os-shell</td><td>å°è¯•è·å–äº¤äº’å¼ Shell (ç³»ç»Ÿå‘½ä»¤è¡Œ)</td></tr>
                                         <tr><td class="text-green-400">--os-pwn</td><td>å°è¯•è·å– OOB Shell, Meterpreter æˆ– VNC</td></tr>
                                     </table>
                                 </div>
                                 
                                 <div class="mb-3">
                                     <h3 class="text-orange-400 font-bold border-b border-slate-700 mb-1">[å¸¸è§„ General]</h3>
                                     <table class="w-full text-left">
                                         <tr><td class="w-1/3 text-green-400">--batch</td><td>éäº¤äº’æ¨¡å¼ (è‡ªåŠ¨ç¡®è®¤ï¼Œè„šæœ¬è°ƒç”¨å¿…å¤‡)</td></tr>
                                         <tr><td class="text-green-400">--flush-session</td><td>æ¸…ç©ºå½“å‰ç›®æ ‡çš„ç¼“å­˜æ–‡ä»¶</td></tr>
                                         <tr><td class="text-green-400">--wizard</td><td>å‘å¯¼æ¨¡å¼ (é€‚åˆåˆå­¦è€…)</td></tr>
                                         <tr><td class="text-green-400">-v &lt;0-6&gt;</td><td>è¯¦ç»†ç¨‹åº¦ (0:åªæ˜¾ç¤ºPythonå›æº¯, 1:é»˜è®¤, 6:HTTPæµé‡)</td></tr>
                                     </table>
                                 </div>
                             </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- MSF æ§åˆ¶å¡ç‰‡ (é»˜è®¤æŠ˜å ) -->
            <div class="bg-slate-800 rounded-lg shadow-lg border border-slate-700 overflow-hidden opacity-90 shrink-0">
                <div class="p-4 bg-slate-800 hover:bg-slate-700 cursor-pointer flex justify-between items-center transition" onclick="toggleCard('msf-body', 'msf-icon')">
                     <div class="flex items-center gap-2">
                        <span id="msf-icon" class="text-slate-400 transition-transform duration-200 -rotate-90">â–¼</span>
                        <h2 class="text-lg font-bold text-red-500 font-mono">Metasploit Framework</h2>
                    </div>
                </div>
                <div id="msf-body" class="hidden p-5 pt-0 border-t border-slate-700/50">
                    <div class="mt-4">
                        <button onclick="window.location.href='/msf'" 
                                class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-4 rounded transition text-sm shadow-lg flex items-center justify-center gap-2">
                            <span>è¿›å…¥ MSF å®Œæ•´æ§åˆ¶å° (Enter MSF Console)</span>
                        </button>
                        <p class="text-xs text-slate-500 mt-2 text-center">
                            * ç‚¹å‡»å°†æ‰“å¼€æ–°çš„å…¨å±ç»ˆç«¯é¡µé¢ï¼Œæ”¯æŒäº¤äº’å¼æ“ä½œ
                        </p>
                    </div>
                </div>
            </div>
            
        </div>
        <!-- å³ä¾§ï¼šæ—¥å¿—ç»ˆç«¯ (å¤šæ ‡ç­¾é¡µ) -->
        <div class="w-2/3 bg-slate-900 rounded-lg shadow-2xl border border-slate-700 flex flex-col neon-border overflow-hidden relative">
            
            <!-- Tab å¯¼èˆªæ  -->
            <div class="flex bg-slate-800 border-b border-slate-700">
                <button onclick="switchTab('system')" id="tab-system" class="px-4 py-2 text-xs font-bold text-blue-400 bg-slate-900 border-r border-slate-700 hover:bg-slate-700 transition">System</button>
                <button onclick="switchTab('nuclei')" id="tab-nuclei" class="px-4 py-2 text-xs font-bold text-slate-500 hover:text-yellow-400 border-r border-slate-700 hover:bg-slate-700 transition">Nuclei</button>
                <button onclick="switchTab('nmap')" id="tab-nmap" class="px-4 py-2 text-xs font-bold text-slate-500 hover:text-indigo-400 border-r border-slate-700 hover:bg-slate-700 transition">Nmap</button>
                <button onclick="switchTab('fscan')" id="tab-fscan" class="px-4 py-2 text-xs font-bold text-slate-500 hover:text-red-400 border-r border-slate-700 hover:bg-slate-700 transition">Fscan</button>
                <button onclick="switchTab('feroxbuster')" id="tab-feroxbuster" class="px-4 py-2 text-xs font-bold text-slate-500 hover:text-cyan-400 border-r border-slate-700 hover:bg-slate-700 transition">Feroxbuster</button>
                <button onclick="switchTab('sqlmap')" id="tab-sqlmap" class="px-4 py-2 text-xs font-bold text-slate-500 hover:text-orange-400 border-r border-slate-700 hover:bg-slate-700 transition">Sqlmap</button>
                
                <!-- å ä½ï¼Œå³ä¾§å·¥å…·æ  -->
                <div class="flex-1 flex justify-end items-center px-2">
                    <button onclick="clearCurrentLog()" class="text-[10px] text-red-400 hover:text-white px-2 py-1 rounded border border-slate-600 hover:bg-red-900 transition">æ¸…ç©ºå½“å‰</button>
                </div>
            </div>

            <!-- ç»ˆç«¯å†…å®¹åŒºå®¹å™¨ -->
            <div class="flex-1 relative overflow-hidden bg-black">
                <!-- System Terminal -->
                <div id="term-system" class="absolute inset-0 overflow-y-auto p-4 terminal-font text-xs leading-relaxed whitespace-pre-wrap text-green-500"></div>
                <!-- Nuclei Terminal -->
                <div id="term-nuclei" class="absolute inset-0 overflow-y-auto p-4 terminal-font text-xs leading-relaxed whitespace-pre-wrap text-yellow-100 hidden"></div>
                <!-- Nmap Terminal -->
                <div id="term-nmap" class="absolute inset-0 overflow-y-auto p-4 terminal-font text-xs leading-relaxed whitespace-pre-wrap text-indigo-100 hidden"></div>
                <!-- Fscan Terminal -->
                <div id="term-fscan" class="absolute inset-0 overflow-y-auto p-4 terminal-font text-xs leading-relaxed whitespace-pre-wrap text-red-100 hidden"></div>
                <!-- Feroxbuster Terminal -->
                <div id="term-feroxbuster" class="absolute inset-0 overflow-y-auto p-4 terminal-font text-xs leading-relaxed whitespace-pre-wrap text-cyan-100 hidden"></div>
                <!-- Sqlmap Terminal -->
                <div id="term-sqlmap" class="absolute inset-0 overflow-y-auto p-4 terminal-font text-xs leading-relaxed whitespace-pre-wrap text-orange-100 hidden"></div>
            </div>
            
            <!-- åº•éƒ¨è¾“å…¥æ¡† -->
            <div class="bg-slate-800 p-2 border-t border-slate-700 flex items-center gap-2">
                <span class="text-green-500 font-bold text-sm">$</span>
                <input type="text" id="termInput" class="flex-1 bg-transparent text-slate-200 text-xs font-mono outline-none placeholder-slate-600" 
                       placeholder="åœ¨æ­¤è¾“å…¥äº¤äº’æŒ‡ä»¤ (å¦‚ Sqlmap è¯¢é—®æ—¶)..." onkeydown="handleInput(event)" autocomplete="off">
            </div>
        </div>
    </div>

    <!-- é€»è¾‘è„šæœ¬ -->
    <!-- é€»è¾‘è„šæœ¬ -->
        <!-- é€»è¾‘è„šæœ¬ -->
    <script>
        // --- ä¿®å¤3: å¼ºåˆ¶ä½¿ç”¨ websocket æ¨¡å¼ï¼Œæ›´ç¨³å®š ---
        const socket = io({ 
            transports: ['websocket'],
            reconnectionDelay: 1000,
            reconnectionDelayMax: 5000
        });

        const cpuEl = document.getElementById('cpuVal');
        
        // Tab ç®¡ç†
        let activeTab = 'system';
        const tabs = ['system', 'nuclei', 'nmap', 'fscan', 'feroxbuster', 'sqlmap'];

        // ç‹¬ç«‹è·Ÿè¸ªæ¯ä¸ªå·¥å…·çš„è¿è¡ŒçŠ¶æ€
        const runningStatus = {
            'system': false,
            'nuclei': false,
            'nmap': false,
            'fscan': false,
            'feroxbuster': false,
            'sqlmap': false
        };

        function switchTab(tabName) {
            activeTab = tabName;
            
            // 1. æ›´æ–°æŒ‰é’®æ ·å¼
            tabs.forEach(t => {
                const btn = document.getElementById(`tab-${t}`);
                if (t === tabName) {
                    btn.classList.remove('text-slate-500', 'bg-transparent');
                    btn.classList.add('bg-slate-900', 'text-blue-400'); // Active style
                    // æ¢å¤ç‰¹å®šé¢œè‰²é«˜äº®
                    if(t === 'nuclei') btn.classList.add('text-yellow-400');
                    if(t === 'nmap') btn.classList.add('text-indigo-400');
                    if(t === 'fscan') btn.classList.add('text-red-400');
                    if(t === 'feroxbuster') btn.classList.add('text-cyan-400');
                    if(t === 'sqlmap') btn.classList.add('text-orange-400');
                } else {
                    btn.classList.add('text-slate-500');
                    btn.classList.remove('bg-slate-900', 'text-blue-400', 'text-yellow-400', 'text-indigo-400', 'text-red-400', 'text-cyan-400', 'text-orange-400');
                }
            });

            // 2. åˆ‡æ¢å†…å®¹æ˜¾ç¤º
            tabs.forEach(t => {
                const div = document.getElementById(`term-${t}`);
                if (t === tabName) {
                    div.classList.remove('hidden');
                    // è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
                    div.scrollTop = div.scrollHeight;
                } else {
                    div.classList.add('hidden');
                }
            });
            
            // èšç„¦è¾“å…¥æ¡†
            document.getElementById('termInput').focus();
        }

        // å¢åŠ è¿æ¥çŠ¶æ€ç›‘æ§
        socket.on('connect', () => {
            logToTerm('system', `\n[CONN] å·²è¿æ¥åˆ°æœåŠ¡å™¨ (ID: ${socket.id})\n`);
        });

        socket.on('disconnect', () => {
             logToTerm('system', `\n[CONN] è¿æ¥æ–­å¼€! æ­£åœ¨é‡è¿...\n`);
             cpuEl.innerText = "Offline";
             cpuEl.style.color = "gray";
        });

        const sysEl = document.getElementById('cpuVal');
        // ç›‘å¬æ–°çš„ç³»ç»ŸçŠ¶æ€
        socket.on('sys-update', (data) => {
            // data æ ¼å¼: { load: "0.15", mem: "30.5" }
            sysEl.innerText = `Load: ${data.load} | Mem: ${data.mem}%`;
            
            // å¦‚æœè´Ÿè½½è¶…è¿‡ 2.0 (æ ‘è“æ´¾é€šå¸¸æ˜¯4æ ¸ï¼Œè¶…è¿‡2å°±å¾ˆå¿™äº†)
            if(parseFloat(data.load) > 2.0) {
                sysEl.className = 'font-bold text-red-500';
            } else {
                sysEl.className = 'font-bold text-green-400';
            }
        });

        // --- æ ¸å¿ƒæ—¥å¿—å¤„ç† ---
        socket.on('log', (msgObj) => {
            // å…¼å®¹æ—§æ ¼å¼ (å¦‚æœæ˜¯å­—ç¬¦ä¸²ï¼Œé»˜è®¤ system)
            let source = 'system';
            let data = '';

            if (typeof msgObj === 'string') {
                data = msgObj;
            } else {
                source = msgObj.source || 'system';
                data = msgObj.data;
            }

            logToTerm(source, data);
        });

        // æ¸…ç† ANSI è½¬ä¹‰åºåˆ—
        function stripAnsi(str) {
            return str.replace(/\x1b\[[0-9;]*m|\[\d+m/g, '');
        }

        function logToTerm(source, text) {
            const termId = `term-${source}`;
            const div = document.getElementById(termId);
            if (div) {
                // æ¸…ç† ANSI é¢œè‰²ä»£ç ï¼Œæ˜¾ç¤ºçº¯æ–‡æœ¬
                const cleanText = stripAnsi(text);
                div.innerText += cleanText;
                // è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
                div.scrollTop = div.scrollHeight;

                // å¦‚æœæ”¶åˆ°æ—¥å¿—çš„ä¸æ˜¯å½“å‰ Tabï¼Œç»™ Tab æŒ‰é’®åŠ é—ªçƒæ•ˆæœ
                if (source !== activeTab) {
                    const btn = document.getElementById(`tab-${source}`);
                    if (btn) {
                        btn.classList.add('animate-pulse');
                        setTimeout(() => btn.classList.remove('animate-pulse'), 1000);
                    }
                }
            }
        }

        socket.on('scan-status', (data) => {
            // data æ ¼å¼å¯èƒ½æ˜¯å­—ç¬¦ä¸² (æ—§) æˆ– { type: 'nmap', status: 'running' } (æ–°)
            let type = 'nuclei'; // é»˜è®¤
            let status = 'stopped';

            if (typeof data === 'string') {
                status = data;
                // æ—§ä»£ç æ²¡æœ‰åŒºåˆ†ï¼Œé»˜è®¤ nuclei
            } else {
                type = data.type;
                status = data.status;
            }

            // æ›´æ–°ç‹¬ç«‹çŠ¶æ€è·Ÿè¸ª
            runningStatus[type] = (status === 'running');

            // --- æ›´æ–°å¯¹åº”å·¥å…·çš„ UI ---
            updateToolUI(type, status);
        });

        // ç‹¬ç«‹çš„ UI æ›´æ–°å‡½æ•°
        function updateToolUI(type, status) {
            // å¯¹äº system (Ping)ï¼Œæ›´æ–° nuclei å¡ç‰‡ä¸Šçš„ Ping åœæ­¢æŒ‰é’®
            if (type === 'system') {
                const btnStop = document.getElementById('btnStop');
                if (status === 'running') {
                    if(btnStop) {
                        btnStop.disabled = false;
                        btnStop.classList.remove('bg-red-900', 'text-slate-400', 'cursor-not-allowed');
                        btnStop.classList.add('bg-red-600', 'text-white', 'hover:bg-red-700');
                    }
                } else {
                    // åªæœ‰å½“ nuclei ä¹Ÿä¸åœ¨è¿è¡Œæ—¶æ‰ç¦ç”¨æŒ‰é’®
                    if (!runningStatus['nuclei'] && btnStop) {
                        btnStop.disabled = true;
                        btnStop.classList.add('bg-red-900', 'text-slate-400', 'cursor-not-allowed');
                        btnStop.classList.remove('bg-red-600', 'text-white', 'hover:bg-red-700');
                    }
                }
                // æ›´æ–° nuclei å¡ç‰‡çš„ badgeï¼ˆæ˜¾ç¤ºä»»ä¸€è¿è¡ŒçŠ¶æ€ï¼‰
                updateNucleiBadge();
                return;
            }

            // å¯¹äº nucleiï¼Œéœ€è¦ç‰¹æ®Šå¤„ç†ï¼ˆä¸ system å…±äº« UIï¼‰
            if (type === 'nuclei') {
                const btnStop = document.getElementById('btnStop');
                if (status === 'running') {
                    if(btnStop) {
                        btnStop.disabled = false;
                        btnStop.classList.remove('bg-red-900', 'text-slate-400', 'cursor-not-allowed');
                        btnStop.classList.add('bg-red-600', 'text-white', 'hover:bg-red-700');
                    }
                } else {
                    // åªæœ‰å½“ system ä¹Ÿä¸åœ¨è¿è¡Œæ—¶æ‰ç¦ç”¨æŒ‰é’®
                    if (!runningStatus['system'] && btnStop) {
                        btnStop.disabled = true;
                        btnStop.classList.add('bg-red-900', 'text-slate-400', 'cursor-not-allowed');
                        btnStop.classList.remove('bg-red-600', 'text-white', 'hover:bg-red-700');
                    }
                }
                // æ›´æ–° nuclei å¡ç‰‡çš„ badge
                updateNucleiBadge();
                return;
            }

            // å…¶ä»–å·¥å…·ï¼šç‹¬ç«‹ UI
            const badge = document.getElementById(`${type}Badge`);
            let stopBtnId = `btn${type.charAt(0).toUpperCase() + type.slice(1)}Stop`;
            const btnStop = document.getElementById(stopBtnId);

            if (status === 'running') {
                if(btnStop) {
                    btnStop.disabled = false;
                    btnStop.classList.remove('bg-red-900', 'text-slate-400', 'cursor-not-allowed');
                    btnStop.classList.add('bg-red-600', 'text-white', 'hover:bg-red-700');
                }

                if(badge) {
                    badge.innerText = "RUNNING";
                    badge.classList.remove('hidden');
                }
            } else {
                if(btnStop) {
                    btnStop.disabled = true;
                    btnStop.classList.add('bg-red-900', 'text-slate-400', 'cursor-not-allowed');
                    btnStop.classList.remove('bg-red-600', 'text-white', 'hover:bg-red-700');
                }

                if(badge) {
                    badge.classList.add('hidden');
                }
            }
        }

        // æ›´æ–° nuclei å¡ç‰‡çš„ badgeï¼ˆè€ƒè™‘ system å’Œ nuclei çš„ç»„åˆçŠ¶æ€ï¼‰
        function updateNucleiBadge() {
            const badge = document.getElementById('scanBadge'); // nuclei å¡ç‰‡çš„ badge ID
            if (!badge) return;

            if (runningStatus['nuclei'] || runningStatus['system']) {
                badge.innerText = "RUNNING";
                badge.classList.remove('hidden');
            } else {
                badge.classList.add('hidden');
            }
        }

        // --- è¾“å…¥å¤„ç† ---
        function handleInput(e) {
            if (e.key === 'Enter') {
                const input = document.getElementById('termInput');
                const val = input.value;
                if (val) {
                    // å‘é€ç»™åç«¯ï¼Œé™„å¸¦å½“å‰ Tab çš„ç±»å‹
                    socket.emit('term-input', { type: activeTab, input: val });
                    
                    input.value = '';
                }
            }
        }

        function clearCurrentLog() {
            const div = document.getElementById(`term-${activeTab}`);
            if(div) div.innerText = "";
        }

        // --- é€šç”¨åœæ­¢ä»»åŠ¡ ---
        function stopTask(type) {
            socket.emit('stop-scan', type);
        }

        // --- ä¿®å¤ç‚¹ï¼šå°† startPing ç‹¬ç«‹å‡ºæ¥ ---
        function startPing() {
            const target = document.getElementById('targetInput').value;
            if(!target) {
                alert("è¯·è¾“å…¥ç›®æ ‡ IPï¼");
                return;
            }
            switchTab('system'); // åˆ‡åˆ° System Tab
            socket.emit('start-ping', { target: target });
        }

        // --- ä¿®å¤ç‚¹ï¼šstartNuclei ç°åœ¨åªè´Ÿè´£ Nuclei ---
        function startNuclei() {
            const target = document.getElementById('targetInput').value;
            const customArgs = document.getElementById('argsInput').value;
            
            if(!target && !customArgs) { 
                alert("è¯·è¾“å…¥ç›®æ ‡æˆ–è‡ªå®šä¹‰å‚æ•°"); 
                return; 
            }
            switchTab('nuclei'); // åˆ‡åˆ° Nuclei Tab
            socket.emit('start-nuclei', { target: target, args: customArgs });
        }

        function stopNuclei() {
            stopTask('nuclei');
        }

        // --- é€šç”¨æŠ˜å å¡ç‰‡é€»è¾‘ ---
        function toggleCard(bodyId, iconId) {
            const content = document.getElementById(bodyId);
            const icon = document.getElementById(iconId);
            
            if (content.classList.contains('hidden')) {
                // å±•å¼€
                content.classList.remove('hidden');
                // æ—‹è½¬ç®­å¤´å‘ä¸‹ (æ ¹æ® Tailwind æˆ– CSS transform)
                icon.style.transform = 'rotate(0deg)';
            } else {
                // æŠ˜å 
                content.classList.add('hidden');
                // æ—‹è½¬ç®­å¤´å‘å³ (å‡è®¾é»˜è®¤å‘ä¸‹)
                icon.style.transform = 'rotate(-90deg)';
            }
        }

        // --- Nmap Start ---
        function startNmap() {
            const target = document.getElementById('nmapTargetInput').value;
            const args = document.getElementById('nmapArgsInput').value;

            if(!target && !args) {
                alert("è¯·è¾“å…¥ç›®æ ‡æˆ–å‚æ•°");
                return;
            }
            switchTab('nmap');
            socket.emit('start-nmap', { target: target, args: args });
        }
        
        // --- Fscan Start ---
        function startFscan() {
            const target = document.getElementById('fscanTargetInput').value;
            const args = document.getElementById('fscanArgsInput').value;

            if(!target && !args) {
                alert("è¯·è¾“å…¥ç›®æ ‡ IP æˆ–å‚æ•°");
                return;
            }
            switchTab('fscan');
            socket.emit('start-fscan', { target: target, args: args });
        }
        
        // --- Sqlmap Start ---
        function startSqlmap() {
            const target = document.getElementById('sqlmapTargetInput').value;
            const args = document.getElementById('sqlmapArgsInput').value;

            if(!target && !args) {
                alert("è¯·è¾“å…¥ç›®æ ‡ URL æˆ–å‚æ•°");
                return;
            }
            switchTab('sqlmap');
            socket.emit('start-sqlmap', { target: target, args: args });
        }

        // --- Feroxbuster Start ---
        function startFeroxbuster() {
            const target = document.getElementById('feroxbusterTargetInput').value;
            const args = document.getElementById('feroxbusterArgsInput').value;

            if(!target && !args) {
                alert("è¯·è¾“å…¥ç›®æ ‡ URL æˆ–å‚æ•°");
                return;
            }
            switchTab('feroxbuster');
            socket.emit('start-feroxbuster', { target: target, args: args });
        }
        
        // é¢„ç•™ MSF
        function sendMsf(cmd) { socket.emit('start-msf-command', cmd); }
    </script>
